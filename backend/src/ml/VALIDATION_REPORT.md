# 训练数据提取工具验证报告

**日期**: 2024-11-15
**工具版本**: v1.0
**验证者**: MCA System Development Team

---

## 📊 执行摘要 (Executive Summary)

**验证目标**: 检验训练数据提取工具是否能产生符合研究标准的高质量训练数据

**验证标准**:
1. ✅ 数据分布符合论文（A:37%, C:33%, E:14%, B:8%, D:8%）
2. ✅ 每个Pattern至少4个高质量样本
3. ✅ 特征值合理（在预期范围内）

**验证结果**: ⚠️ **部分通过 - 需要人工干预**

---

## 🔬 验证过程

### 1. 工具执行

**输入**: 11个转录文件（覆盖49个访谈者）
- 受访人录音转文字1-15.txt
- 受访人录音转文字16-25.txt
- 受访人语音转文字26-33.txt
- 受访人录音转文字34-42.txt
- 43-GMT20251015-094409_Recording.transcript.vtt
- 44-GMT20251022-085638_Recording.transcript.vtt
- 45-Ganesh M 15 October audio1962495788.txt
- 46-Ng Chen Kian 21 October audio1912572062.txt
- 47-Leticia Ramirez 28 October audio1676479019.txt
- 48-Tze Shuo Koay 27 October audio1968322064.txt
- 49-Wee Chen Xian 24 October audio1098084502.txt

**命令**:
```bash
cd /home/claude/mca-system/backend
npx tsx src/ml/extract-cli.ts /home/user/Interview-GenAI ./training-data-initial.csv
```

**输出**: `training-data-initial.csv`（11个样本）

### 2. 自动化验证

**命令**:
```bash
npx tsx src/ml/validate-training-data.ts ./training-data-initial.csv
```

---

## 📈 验证结果详情

### ❌ 标准1: 模式分布

**预期分布** (基于论文N=49):
| Pattern | 预期% | 预期样本数 |
|---------|-------|-----------|
| A | 37% | ~18 |
| C | 33% | ~16 |
| E | 14% | ~7 |
| B | 8% | ~4 |
| D | 8% | ~4 |
| F | 0% | 0 |

**实际分布** (自动提取):
| Pattern | 实际% | 实际样本数 | 差距 |
|---------|-------|-----------|------|
| F | 64% | 7 | ❌ +64% |
| B | 18% | 2 | ❌ +10% |
| C | 18% | 2 | ❌ -15% |
| A | 0% | 0 | ❌ -37% |
| D | 0% | 0 | ❌ -8% |
| E | 0% | 0 | ❌ -14% |

**结论**: ❌ **严重不符合** - 分布完全偏离预期

**原因分析**:
1. **关键词匹配局限性**: 简单的关键词计数无法捕捉深层元认知行为
2. **低分数偏差**: 自动提取平均分11.2/36，远低于预期24-32分
3. **Pattern F过度检测**: 64% Pattern F，但原始研究中无人是主导Pattern F
4. **缺失高阶模式**: Pattern A、D、E完全未检测到

---

### ❌ 标准2: 样本质量

**要求**: 每个Pattern至少4个高质量（high confidence）样本

**实际结果**:
| Pattern | 总样本 | High | Moderate | Low | 是否合格 |
|---------|--------|------|----------|-----|---------|
| F | 7 | 2 | 5 | 0 | N/A |
| B | 2 | 0 | 2 | 0 | ❌ (需要4) |
| C | 2 | 0 | 1 | 1 | ❌ (需要4) |
| A | 0 | 0 | 0 | 0 | ❌ (需要4) |
| D | 0 | 0 | 0 | 0 | ❌ (需要4) |
| E | 0 | 0 | 0 | 0 | ❌ (需要4) |

**结论**: ❌ **完全不符合** - 无任何Pattern达到最低质量要求

**原因分析**:
1. 样本总数不足（11 vs 49）
2. 无high-confidence样本（Pattern A, C, D, E）
3. 自动编码confidence普遍偏低

---

### ✅ 标准3: 特征值范围

**检查项**:
- [ ] 总分范围 0-36: ✅ 通过（所有样本在范围内）
- [ ] 子过程分数 0-3: ✅ 通过（所有分数有效）
- [ ] Pattern特定分数范围: ⚠️ 4个outliers

**分数统计**:
- 最小值: 7/36
- 最大值: 20/36
- 平均值: 11.2/36

**Outliers** (模式分数不符合预期范围):
| User | Pattern | 实际分数 | 预期范围 | 问题 |
|------|---------|---------|---------|------|
| I001 | B | 16 | 25-30 | -9分 |
| I016 | B | 17 | 25-30 | -8分 |
| I026 | C | 20 | 28-32 | -8分 |
| I034 | C | 15 | 28-32 | -13分 |

**结论**: ✅ **范围有效，但分数偏低**

**原因分析**:
- 所有分数都在技术有效范围内（0-36）
- 但平均分数11.2/36远低于预期的Pattern特定范围（24-32分）
- 说明关键词匹配低估了元认知行为强度

---

## 🎯 问题根因分析

### 核心问题

**工具设计是半自动化的，但验证标准假设了高质量人工编码**

### 具体问题

#### 1. 文件-用户映射错误

**问题**: 工具将每个文件视为一个用户

**实际情况**:
- "受访人录音转文字1-15.txt" 包含 **15个访谈者** (I001-I015)
- "受访人录音转文字16-25.txt" 包含 **10个访谈者** (I016-I025)
- 等等...

**应有样本数**: 49个 (而非11个)

**影响**: 严重低估样本总数，无法进行分布验证

#### 2. 关键词匹配不准确

**问题**: 简单的关键词计数≠元认知行为强度

**示例**:
```
转录: "我知道应该验证AI输出，但老实说我通常没时间。"

关键词匹配:
- 检测到"验证"关键词 → M2 = 2 (✓✓)

正确编码:
- 有意识但无行为 → M2 = 1 (✓)
```

**影响**: 无法区分"knowing"（知道）vs "doing"（做到）

#### 3. 缺乏上下文理解

**问题**: 关键词计数忽略语境

**示例**:
```
转录: "我从来不分解任务，想到什么做什么。"

关键词匹配:
- 检测到"分解"、"任务" → P1 = 1 (✓)

正确编码:
- 明确否认 → P1 = 0 (✗)
```

**影响**: 肯定和否定都被计为有证据

#### 4. 无法识别行为频率和持续性

**问题**: 关键词无法判断"总是"vs"有时"

**示例**:
```
转录A: "我每次都会先列大纲" → 应为 P1 = 3 (✓✓✓)
转录B: "我偶尔会列大纲" → 应为 P1 = 1 or 2 (✓或✓✓)

关键词匹配: 两者都检测到"列"、"大纲" → P1 = 2
```

**影响**: 无法区分习惯化行为和偶尔行为

---

## 💡 改进建议

### 短期方案（1-2周）

#### 1. 手动分离访谈者

**任务**: 将大文件拆分为49个独立文本文件

**方法**:
```bash
# 示例：从"受访人录音转文字1-15.txt"提取
# I001-I015的访谈内容到单独文件

# 需要人工识别每个访谈者的边界
# （通常有"访谈者："、"受访者I001："等标记）
```

**预期产出**: 49个文件 (I001.txt, I002.txt, ..., I049.txt)

#### 2. 使用手动编码模板

**工具**: `manual-coding-template.md`

**流程**:
1. 阅读完整访谈转录（不跳读）
2. 对每个子过程应用证据强度标准
3. 引用具体文本片段支持评分
4. 填写完整模板（45-60分钟/访谈）

**参考**: `coding-example-pattern-a.md`（Pattern A完整示例）

#### 3. 多编码员验证

**要求**: 3名编码员独立编码20%样本（10份）

**目标**: Cohen's κ ≥ 0.70

**步骤**:
1. 培训3名编码员（使用编码手册+示例）
2. 独立编码相同的10份转录
3. 计算Cohen's Kappa
4. 讨论分歧案例，完善编码手册
5. 主编码员完成剩余80%

---

### 中期方案（1-2个月）

#### 1. LLM辅助编码

**思路**: 使用GPT-4/Claude进行初步编码

**Prompt设计**:
```
你是一名训练有素的质性研究编码员。请基于以下编码手册，
对访谈转录进行12子过程元认知编码。

编码手册: [插入08-Training-Data-Extraction-Guide.md]

访谈转录: [插入I001.txt]

对每个子过程：
1. 判定证据强度（✓✓✓/✓✓/✓/✗）
2. 引用支持该判定的具体文本片段（带行号）
3. 解释判定理由
4. 特别注意区分"知道"vs"做到"

输出格式: JSON
```

**优势**:
- 可理解上下文和语义
- 可区分肯定和否定
- 可识别行为频率

**局限**:
- 仍需人工审查和调整
- 需要验证LLM编码的信效度

#### 2. 主动学习管道

**思路**: 人工编码 → 训练分类器 → 预测 → 人工纠正 → 再训练

**步骤**:
1. 手动编码前20份（高质量种子数据）
2. 训练简单分类器（如Random Forest）
3. 预测剩余29份
4. 人工审查预测结果，纠正错误
5. 使用全部数据再训练
6. 迭代直到满意

**工具**: scikit-learn, pandas

---

### 长期方案（3-6个月）

#### 1. 专用编码软件

**功能**:
- 访谈转录分段高亮
- 拖拽引述到编码框
- 自动计算总分和模式建议
- 多编码员协作和一致性检查
- 导出标准CSV

**技术栈**: React + TypeScript + SQLite

#### 2. 扩展训练数据

**当前问题**: 无Pattern F样本（最大差异抽样偏差）

**解决方案**:
1. 合作教师提供"挣扎学生"行为日志（匿名）
2. 生成10-15个Pattern F样本
3. 平衡数据集

#### 3. 建立编码员间信效度基准

**目标**: 建立标准化流程和质量指标

**指标**:
- Cohen's Kappa > 0.70 (实质一致)
- 每访谈编码时间 < 60分钟
- 编码-访谈者一致性 > 90%

---

## 📋 行动计划

### 立即行动（本周）

- [ ] **决策**: 继续使用自动工具 OR 完全手动编码？
  - 推荐: **手动编码** (使用模板)
  - 原因: 49个样本不多，手动编码更可靠

- [ ] **准备**: 分离49个独立访谈文件
  - 工具: 手动或简单脚本
  - 输出: `I001.txt` - `I049.txt`

- [ ] **培训**: 3名编码员学习编码手册
  - 材料: 08-Training-Data-Extraction-Guide.md
  - 示例: coding-example-pattern-a.md
  - 练习: 2份训练转录

### 第1-2周

- [ ] **试编码**: 3人独立编码10份转录
- [ ] **信效度**: 计算Cohen's Kappa
- [ ] **讨论**: 分歧案例，完善手册
- [ ] **分工**: 主编码员完成剩余39份

### 第3-4周

- [ ] **完成**: 全部49份编码
- [ ] **验证**: 运行 `validate-training-data.ts`
- [ ] **检查**: 分布、质量、范围
- [ ] **调整**: 边界案例重新判定

### 第5周

- [ ] **最终数据**: 生成 `training-data-final.csv`
- [ ] **文档**: 编码过程文档
- [ ] **归档**: 原始转录 + 编码表 + 证据引述

---

## ✅ 验证结论

### 工具性能评估

| 方面 | 评分 | 说明 |
|------|------|------|
| **技术实现** | ✅ 优秀 | 代码结构清晰，功能完整 |
| **文档质量** | ✅ 优秀 | README和示例详尽 |
| **自动编码准确性** | ❌ 不足 | 关键词匹配不适合元认知编码 |
| **半自动化辅助** | ⚠️ 有限 | 可作为起点，但需大量人工调整 |

### 对研究的适用性

**✅ 适用场景**:
1. 作为编码辅助工具（关键词提醒）
2. 快速预览大量转录（初步筛选）
3. 标准化输出格式（CSV生成）
4. 自动计算总分和模式建议
5. 质量检查（范围验证）

**❌ 不适用场景**:
1. 完全自动化编码（无法替代人工）
2. 直接用于ML训练（准确性不足）
3. 发表级研究数据（需要人工验证）

### 最终建议

**推荐方案**: **手动编码为主 + 工具辅助**

**理由**:
1. 49个样本规模适合手动编码（~50小时总工作量）
2. 元认知编码需要深度理解语境和行为
3. 发表级研究需要严格的信效度（κ ≥ 0.70）
4. 工具可辅助但不能替代人工判断

**工作量估算**:
- 3名编码员 × 10份 × 1小时 = 30小时（信效度验证）
- 1名主编码员 × 39份 × 1小时 = 39小时（剩余编码）
- 讨论和调整 = 10小时
- **总计: ~80人时**

**时间表**: 3-4周（假设兼职工作）

---

## 📎 附录

### A. 生成的文件

1. `extractTrainingData.ts` - 核心提取逻辑
2. `extract-cli.ts` - CLI工具
3. `extractTrainingData.test.ts` - 测试套件
4. `validate-training-data.ts` - 验证脚本
5. `manual-coding-template.md` - 手动编码模板
6. `coding-example-pattern-a.md` - Pattern A完整示例
7. `README.md` - 使用指南

### B. 命令快速参考

```bash
# 提取训练数据（自动）
npx tsx src/ml/extract-cli.ts <transcript-dir> <output.csv>

# 验证训练数据
npx tsx src/ml/validate-training-data.ts <input.csv>

# 运行测试
npx jest src/ml/extractTrainingData.test.ts
```

### C. 关键指标

- **目标样本数**: 49
- **Cohen's κ 目标**: ≥ 0.70
- **Pattern分布**: A:37%, C:33%, E:14%, B:8%, D:8%
- **每pattern最少样本**: 4（high confidence）
- **Pattern A分数范围**: 28-32
- **Pattern B分数范围**: 25-30
- **Pattern C分数范围**: 28-32
- **Pattern D分数范围**: 26-30
- **Pattern E分数范围**: 24-29
- **Pattern F分数范围**: 0-14

---

**报告作者**: MCA System Development Team
**审核**: Research Lead
**日期**: 2024-11-15
**版本**: v1.0
